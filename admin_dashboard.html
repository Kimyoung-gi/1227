<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: #f8f9fa;
        }
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .navbar-brand {
            color: white !important;
            font-weight: bold;
        }
        .nav-link {
            color: rgba(255,255,255,0.8) !important;
        }
        .nav-link:hover {
            color: white !important;
        }
        .main-container {
            padding: 2rem;
        }
        .upload-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        .upload-area {
            border: 2px dashed #667eea;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            background: #f8f9ff;
            transition: all 0.3s ease;
        }
        .upload-area:hover {
            border-color: #764ba2;
            background: #f0f2ff;
        }
        .upload-area.dragover {
            border-color: #764ba2;
            background: #e8ecff;
        }
        .file-input {
            display: none;
        }
        .btn-upload {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            padding: 12px 30px;
            font-weight: bold;
            color: white;
        }
        .btn-upload:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .info-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        .csv-template {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-cog me-2"></i>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="index.html">
                    <i class="fas fa-home me-1"></i>ë©”ì¸ í˜ì´ì§€
                </a>
            </div>
        </div>
    </nav>

    <div class="container main-container">
        <div class="row">
            <div class="col-lg-8">
                <div class="upload-card">
                    <h3 class="mb-4">
                        <i class="fas fa-upload me-2"></i>CSV íŒŒì¼ ì—…ë¡œë“œ
                    </h3>
                    
                    <form id="uploadForm">
                        <div class="upload-area" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                            <h5>CSV íŒŒì¼ì„ ì„ íƒí•˜ê±°ë‚˜ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</h5>
                            <p class="text-muted">ì§€ì› í˜•ì‹: CSV íŒŒì¼</p>
                            <input type="file" class="file-input" id="csvFile" name="file" accept=".csv" multiple required>
                            <button type="button" class="btn btn-upload" onclick="document.getElementById('csvFile').click()">
                                <i class="fas fa-folder-open me-2"></i>íŒŒì¼ ì„ íƒ
                            </button>
                            <div id="fileInfo" style="display: none;"></div>
                        </div>
                        
                        <div class="mt-3">
                            <button type="submit" class="btn btn-upload" id="uploadBtn" style="display: none;">
                                <i class="fas fa-upload me-2"></i>ì—…ë¡œë“œ
                            </button>
                            
                            <!-- ë””ë²„ê¹… ë²„íŠ¼ -->
                            <button type="button" class="btn btn-outline-info btn-sm ms-2" onclick="debugFirebase()">
                                <i class="fas fa-bug me-1"></i>Firebase ë””ë²„ê·¸
                            </button>
                            
                            <!-- ì—…ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ -->
                            <div id="uploadProgress" style="display: none;" class="mt-3">
                                <div class="card">
                                    <div class="card-body">
                                        <h6 class="card-title">
                                            <i class="fas fa-spinner fa-spin me-2"></i>íŒŒì¼ ì—…ë¡œë“œ ì¤‘...
                                        </h6>
                                        <div class="progress mb-3">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                                 id="progressBar" 
                                                 role="progressbar" 
                                                 style="width: 0%" 
                                                 aria-valuenow="0" 
                                                 aria-valuemin="0" 
                                                 aria-valuemax="100">
                                                0%
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <small class="text-muted">
                                                    <i class="fas fa-file-csv me-1"></i>
                                                    ì²˜ë¦¬ëœ íŒŒì¼: <span id="processedFiles">0</span> / <span id="totalFiles">0</span>
                                                </small>
                                            </div>
                                            <div class="col-md-6">
                                                <small class="text-muted">
                                                    <i class="fas fa-database me-1"></i>
                                                    ì´ ë°ì´í„°: <span id="totalJobs">0</span>ê°œ
                                                </small>
                                            </div>
                                        </div>
                                        <div class="mt-2">
                                            <small class="text-muted" id="currentFile">í˜„ì¬ ì²˜ë¦¬ ì¤‘: -</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="info-card">
                    <h5><i class="fas fa-info-circle me-2"></i>CSV íŒŒì¼ í˜•ì‹</h5>
                    <p>ë‹¤ìŒ ì»¬ëŸ¼ì´ í¬í•¨ëœ CSV íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”:</p>
                    <ul>
                        <li><strong>íšŒì‚¬ëª…</strong> - ê¸°ì—…ëª…</li>
                        <li><strong>ì§ë¬´</strong> - ì±„ìš© ì§ë¬´</li>
                        <li><strong>ì¼ì •</strong> - ì˜¤í”ˆ ì¼ì •</li>
                        <li><strong>ë“±ë¡ì¼/ìˆ˜ì •ì¼</strong> - ë“±ë¡ ë‚ ì§œ</li>
                        <li><strong>ì£¼ì†Œ</strong> - íšŒì‚¬ ì£¼ì†Œ</li>
                    </ul>
                </div>
                
                <div class="info-card">
                    <h5><i class="fas fa-file-csv me-2"></i>CSV í…œí”Œë¦¿</h5>
                    <div class="csv-template">
íšŒì‚¬ëª…,ì§ë¬´,ì¼ì •,ë“±ë¡ì¼/ìˆ˜ì •ì¼,ì£¼ì†Œ
ABCíšŒì‚¬,ë§¤ì¥ì§,ì˜¤í”ˆ ì˜ˆì •,25/07/11,ì„œìš¸ ê°•ë‚¨êµ¬
XYZê¸°ì—…,ì˜ì—…ì§,ì˜¤í”ˆ ì˜ˆì •,25/07/12,ê²½ê¸° ì„±ë‚¨ì‹œ
                    </div>
                </div>
                
                <div class="info-card">
                    <h5><i class="fas fa-history me-2"></i>ìµœê·¼ ì—…ë¡œë“œ ì •ë³´</h5>
                    <div id="uploadHistory">
                        <p class="text-muted">ì•„ì§ ì—…ë¡œë“œëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            const fileInput = document.getElementById('csvFile');
            const fileInfo = document.getElementById('fileInfo');
            const uploadBtn = document.getElementById('uploadBtn');
            const uploadArea = document.getElementById('uploadArea');
            const uploadProgress = document.getElementById('uploadProgress');
            const progressBar = document.getElementById('progressBar');
            const processedFilesSpan = document.getElementById('processedFiles');
            const totalFilesSpan = document.getElementById('totalFiles');
            const totalJobsSpan = document.getElementById('totalJobs');
            const currentFileSpan = document.getElementById('currentFile');
            
            // ì—…ë¡œë“œ íˆìŠ¤í† ë¦¬ í‘œì‹œ
            displayUploadHistory();
            
            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤
            function updateProgress(processed, total, currentFileName = '') {
                const progress = Math.round((processed / total) * 100);
                progressBar.style.width = progress + '%';
                progressBar.setAttribute('aria-valuenow', progress);
                progressBar.textContent = progress + '%';
                
                processedFilesSpan.textContent = processed;
                totalFilesSpan.textContent = total;
                currentFileSpan.textContent = currentFileName ? `í˜„ì¬ ì²˜ë¦¬ ì¤‘: ${currentFileName}` : 'í˜„ì¬ ì²˜ë¦¬ ì¤‘: -';
            }
            
            function showUploadProgress() {
                uploadProgress.style.display = 'block';
                uploadBtn.style.display = 'none';
                updateProgress(0, 0);
            }
            
            function hideUploadProgress() {
                uploadProgress.style.display = 'none';
                uploadBtn.style.display = 'inline-block';
            }
            
            // Firebase ë””ë²„ê¹… í•¨ìˆ˜
            async function debugFirebase() {
                console.log('ğŸ” Firebase ë””ë²„ê¹… ì‹œì‘...');
                
                try {
                    // Firebase ìƒíƒœ í™•ì¸
                    if (typeof firebase === 'undefined') {
                        alert('âŒ Firebase SDKê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    if (firebase.apps.length === 0) {
                        alert('âŒ Firebaseê°€ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    console.log('âœ… Firebase ì´ˆê¸°í™”ë¨');
                    
                    // Firestore ì—°ê²° í™•ì¸
                    const db = firebase.firestore();
                    console.log('âœ… Firestore ì—°ê²°ë¨');
                    
                    // ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì—…ë¡œë“œ
                    const testData = {
                        company: 'ë””ë²„ê·¸í…ŒìŠ¤íŠ¸',
                        title: 'í…ŒìŠ¤íŠ¸ì§ë¬´',
                        schedule: 'í…ŒìŠ¤íŠ¸ì¼ì •',
                        reg_date: '25/07/11',
                        address: 'í…ŒìŠ¤íŠ¸ì£¼ì†Œ',
                        debug: true,
                        timestamp: new Date()
                    };
                    
                    console.log('ğŸ“ í…ŒìŠ¤íŠ¸ ë°ì´í„°:', testData);
                    
                    const docRef = await db.collection('debug').add(testData);
                    console.log('âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ì—…ë¡œë“œ ì„±ê³µ! ë¬¸ì„œ ID:', docRef.id);
                    
                    // í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ
                    await docRef.delete();
                    console.log('ğŸ—‘ï¸ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œë¨');
                    
                    alert('âœ… Firebase ì—°ê²°ì´ ì •ìƒì…ë‹ˆë‹¤!\n\nì½˜ì†”ì—ì„œ ìì„¸í•œ ë¡œê·¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                    
                } catch (error) {
                    console.error('âŒ Firebase ë””ë²„ê¹… ì˜¤ë¥˜:', error);
                    alert(`âŒ Firebase ì˜¤ë¥˜:\n\n${error.message}\n\nì½˜ì†”ì—ì„œ ìì„¸í•œ ì˜¤ë¥˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                }
            }
            
            // íŒŒì¼ ì„ íƒ ì‹œ íŒŒì¼ëª… í‘œì‹œ
            fileInput.addEventListener('change', function(e) {
                const files = e.target.files;
                
                if (files.length > 0) {
                    let fileInfoHTML = `
                        <div class="mt-3">
                            <i class="fas fa-file-csv fa-3x text-success mb-3"></i>
                            <h5>ì„ íƒëœ íŒŒì¼: ${files.length}ê°œ</h5>
                    `;
                    
                    let totalSize = 0;
                    for (let i = 0; i < files.length; i++) {
                        const file = files[i];
                        totalSize += file.size;
                        fileInfoHTML += `
                            <div class="mb-2">
                                <strong>${i + 1}. ${file.name}</strong>
                                <span class="text-muted">(${(file.size / 1024).toFixed(2)} KB)</span>
                            </div>
                        `;
                    }
                    
                    fileInfoHTML += `
                            <p class="text-muted">ì´ í¬ê¸°: ${(totalSize / 1024).toFixed(2)} KB</p>
                        </div>
                    `;
                    
                    fileInfo.innerHTML = fileInfoHTML;
                    fileInfo.style.display = 'block';
                    uploadBtn.style.display = 'inline-block';
                } else {
                    fileInfo.style.display = 'none';
                    uploadBtn.style.display = 'none';
                }
            });
            
            // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥
            uploadArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });
            
            uploadArea.addEventListener('dragleave', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
            });
            
            uploadArea.addEventListener('drop', function(e) {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    // CSV íŒŒì¼ë§Œ í•„í„°ë§
                    const csvFiles = Array.from(files).filter(file => 
                        file.type === 'text/csv' || file.name.endsWith('.csv')
                    );
                    
                    if (csvFiles.length === 0) {
                        alert('CSV íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                        return;
                    }
                    
                    // FileList ê°ì²´ ìƒì„± (ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ìœ„í•´)
                    const dataTransfer = new DataTransfer();
                    csvFiles.forEach(file => dataTransfer.items.add(file));
                    fileInput.files = dataTransfer.files;
                    fileInput.dispatchEvent(new Event('change'));
                }
            });
            
            // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ (í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ë“œ)
            const uploadForm = document.getElementById('uploadForm');
            uploadForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const files = fileInput.files;
                if (!files || files.length === 0) {
                    alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // CSV íŒŒì¼ë§Œ í•„í„°ë§
                const csvFiles = Array.from(files).filter(file => 
                    file.name.endsWith('.csv') || file.type === 'text/csv'
                );
                
                if (csvFiles.length === 0) {
                    alert('CSV íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    return;
                }
                
                // ì—…ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ ì‹œì‘
                showUploadProgress();
                updateProgress(0, csvFiles.length);
                
                // ì—¬ëŸ¬ íŒŒì¼ ìˆœì°¨ ì²˜ë¦¬
                let allJobsData = [];
                let processedFiles = 0;
                let totalFiles = csvFiles.length;
                
                function processNextFile(index) {
                    if (index >= csvFiles.length) {
                        // ëª¨ë“  íŒŒì¼ ì²˜ë¦¬ ì™„ë£Œ
                        if (allJobsData.length === 0) {
                            alert('ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. CSV íŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                            return;
                        }
                        
                        // Firebaseì— ì—…ë¡œë“œ
                        const uploadPromises = [];
                        csvFiles.forEach((file, fileIndex) => {
                            const fileData = allJobsData[fileIndex];
                            if (fileData && fileData.length > 0) {
                                uploadPromises.push(
                                    firebaseDB.uploadJobs(fileData, file.name)
                                );
                            }
                        });
                        
                        Promise.all(uploadPromises).then(results => {
                            const successCount = results.filter(r => r.success).length;
                            const totalJobs = allJobsData.reduce((sum, data) => sum + data.length, 0);
                            
                            // ì§„í–‰ë¥  í‘œì‹œ ìˆ¨ê¸°ê¸°
                            hideUploadProgress();
                            
                            if (successCount > 0) {
                                alert(`íŒŒì¼ ì—…ë¡œë“œ ì„±ê³µ!\n\nì²˜ë¦¬ëœ íŒŒì¼: ${successCount}/${totalFiles}ê°œ\nì´ ì±„ìš©ì •ë³´: ${totalJobs}ê°œ\n\nëª¨ë“  ê¸°ê¸°ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`);
                                
                                // ì—…ë¡œë“œ íˆìŠ¤í† ë¦¬ ì €ì¥
                                const fileNames = csvFiles.map(file => file.name);
                                const allJobs = allJobsData.flat();
                                saveUploadHistory(fileNames, totalJobs, allJobs);
                                
                                // íŒŒì¼ ì •ë³´ ì´ˆê¸°í™”
                                fileInput.value = '';
                                fileInfo.style.display = 'none';
                                
                                // ì—…ë¡œë“œ íˆìŠ¤í† ë¦¬ ì—…ë°ì´íŠ¸
                                displayUploadHistory();
                            } else {
                                alert('ëª¨ë“  íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                            }
                        }).catch(error => {
                            console.error('Firebase ì—…ë¡œë“œ ì˜¤ë¥˜:', error);
                            hideUploadProgress();
                            alert('ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. Firebase ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                        });
                        
                        return;
                    }
                    
                    const file = csvFiles[index];
                    const reader = new FileReader();
                    
                    // í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ íŒŒì¼ëª… í‘œì‹œ
                    updateProgress(processedFiles, totalFiles, file.name);
                    
                    reader.onload = function(e) {
                        try {
                            const csv = e.target.result;
                            const lines = csv.split('\n').filter(line => line.trim() !== '');
                            
                            if (lines.length < 2) {
                                console.warn(`íŒŒì¼ ${file.name}: ë°ì´í„°ê°€ ì¶©ë¶„í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.`);
                                allJobsData[index] = [];
                                processNextFile(index + 1);
                                return;
                            }
                            
                            const headers = lines[0].split(',').map(h => h.trim());
                            
                            // í•„ìˆ˜ ì»¬ëŸ¼ í™•ì¸
                            const requiredColumns = ['íšŒì‚¬ëª…', 'ì§ë¬´', 'ì¼ì •', 'ë“±ë¡ì¼/ìˆ˜ì •ì¼', 'ì£¼ì†Œ'];
                            const missingColumns = requiredColumns.filter(col => 
                                !headers.some(header => header === col)
                            );
                            
                            if (missingColumns.length > 0) {
                                console.warn(`íŒŒì¼ ${file.name}: í•„ìˆ˜ ì»¬ëŸ¼ ëˆ„ë½ - ${missingColumns.join(', ')}`);
                                allJobsData[index] = [];
                                processNextFile(index + 1);
                                return;
                            }
                            
                            // CSV ë°ì´í„°ë¥¼ ê°ì²´ ë°°ì—´ë¡œ ë³€í™˜
                            const jobsData = [];
                            for (let i = 1; i < lines.length; i++) {
                                const line = lines[i].trim();
                                if (line) {
                                    const values = line.split(',').map(v => v.trim());
                                    
                                    if (values.length >= 5) {
                                        jobsData.push({
                                            company: values[0] || '',
                                            title: values[1] || '',
                                            schedule: values[2] || '',
                                            reg_date: values[3] || '',
                                            address: values[4] || ''
                                        });
                                    }
                                }
                            }
                            
                            allJobsData[index] = jobsData;
                            processedFiles++;
                            
                            // ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
                            updateProgress(processedFiles, totalFiles);
                            
                            // ì´ ë°ì´í„° ê°œìˆ˜ ì—…ë°ì´íŠ¸
                            const currentTotalJobs = allJobsData.reduce((sum, data) => sum + (data ? data.length : 0), 0);
                            totalJobsSpan.textContent = currentTotalJobs;
                            
                            processNextFile(index + 1);
                            
                        } catch (error) {
                            console.error(`íŒŒì¼ ${file.name} ì²˜ë¦¬ ì˜¤ë¥˜:`, error);
                            allJobsData[index] = [];
                            processedFiles++;
                            updateProgress(processedFiles, totalFiles);
                            processNextFile(index + 1);
                        }
                    };
                    
                    reader.onerror = function() {
                        console.error(`íŒŒì¼ ${file.name} ì½ê¸° ì˜¤ë¥˜`);
                        allJobsData[index] = [];
                        processedFiles++;
                        updateProgress(processedFiles, totalFiles);
                        processNextFile(index + 1);
                    };
                    
                    reader.readAsText(file, 'UTF-8');
                }
                
                // ì²« ë²ˆì§¸ íŒŒì¼ë¶€í„° ì²˜ë¦¬ ì‹œì‘
                processNextFile(0);
            });
        });
        
        // ì—…ë¡œë“œ íˆìŠ¤í† ë¦¬ ì €ì¥
        function saveUploadHistory(fileNames, totalDataCount, allJobsData) {
            const uploadInfo = {
                fileNames: fileNames,
                uploadDate: new Date().toLocaleString('ko-KR'),
                totalDataCount: totalDataCount,
                fileCount: fileNames.length,
                sampleData: allJobsData.slice(0, 6) // ì²˜ìŒ 6ê°œ ë°ì´í„°ë§Œ ì €ì¥
            };
            
            localStorage.setItem('uploadHistory', JSON.stringify(uploadInfo));
        }
        
        // ì—…ë¡œë“œ íˆìŠ¤í† ë¦¬ í‘œì‹œ
        function displayUploadHistory() {
            const historyDiv = document.getElementById('uploadHistory');
            const uploadInfo = localStorage.getItem('uploadHistory');
            
            if (uploadInfo) {
                try {
                    const info = JSON.parse(uploadInfo);
                    let historyHTML = `
                        <div class="mb-3">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <strong>íŒŒì¼ ê°œìˆ˜:</strong>
                                <span class="badge bg-primary">${info.fileCount}ê°œ</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <strong>ì—…ë¡œë“œì¼:</strong>
                                <span class="text-muted">${info.uploadDate}</span>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <strong>ì´ ë°ì´í„°:</strong>
                                <span class="badge bg-success">${info.totalDataCount}ê°œ</span>
                            </div>
                        </div>
                    `;
                    
                    if (info.fileNames && info.fileNames.length > 0) {
                        historyHTML += '<div class="border-top pt-3"><strong>ì—…ë¡œë“œëœ íŒŒì¼:</strong><ul class="list-unstyled mt-2">';
                        info.fileNames.forEach((fileName, index) => {
                            historyHTML += `
                                <li class="mb-1">
                                    <div class="small">
                                        <span class="text-muted">${index + 1}. ${fileName}</span>
                                    </div>
                                </li>
                            `;
                        });
                        historyHTML += '</ul></div>';
                    }
                    
                    if (info.sampleData && info.sampleData.length > 0) {
                        historyHTML += '<div class="border-top pt-3"><strong>ìƒ˜í”Œ ë°ì´í„°:</strong><ul class="list-unstyled mt-2">';
                        info.sampleData.forEach(job => {
                            historyHTML += `
                                <li class="mb-2">
                                    <div class="small">
                                        <strong>${job.company}</strong> - ${job.title}<br>
                                        <span class="text-muted">${job.address}</span>
                                    </div>
                                </li>
                            `;
                        });
                        historyHTML += '</ul></div>';
                    }
                    
                    historyDiv.innerHTML = historyHTML;
                } catch (e) {
                    historyDiv.innerHTML = '<p class="text-muted">ì—…ë¡œë“œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                }
            } else {
                historyDiv.innerHTML = '<p class="text-muted">ì•„ì§ ì—…ë¡œë“œëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
        }
    </script>
</body>
</html> 
